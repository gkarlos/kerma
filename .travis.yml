language : cpp
os : linux
dist : bionic
sudo : required
addons :
  apt :
    sources :
      - sourceline: "ppa:ubuntu-toolchain-r/test"
    packages:
      - cmake
      - git
      - doxygen
stages :
  - build

jobs :
  - name : "llvm-10-gcc"
    stage : build
    cache :
      ccache : true
      apt : true
      directories :
        - $HOME/boost/
    env :
      - LLVM_VERSION=10
      - LLVM_HOME=/usr/lib/llvm-10
      - BOOST_ROOT=$HOME/boost/172
    before_script:
      - sudo apt-get install libllvm10 llvm-10 llvm-10-dev llvm-10-runtime
      - sudo apt-get install clang-11 clang-tools-11 libclang-common-11-dev libclang-11-dev libclang1-11 clang-format-11 python-clang-11 clangd-11
      - sudo apt-get install libomp-11-dev
      - chmod +x scripts/travis/install_boost.sh
      - scripts/travis/install_boost.sh
    script:
      - echo $LLVM_HOME
      - ls $LLVM_HOME
      - mkdir build && cd build && cmake ..
      - make

  - name : "llvm-10-clang"
    stage : build
    cache :
      ccache : true
      apt : true
      directories :
        - $HOME/boost/
    env :
      - LLVM_VERSION=10
      - LLVM_HOME=/usr/lib/llvm-10
      - CLANGPP=$LLVM_HOME/bin/clang++
      - CLANG=$LLVM_HOME/bin/clang
      - BOOST_ROOT=$HOME/boost/172
    before_script:
      - sudo apt-get install libllvm10 llvm-10 llvm-10-dev llvm-10-runtime
      - sudo apt-get install clang-11 clang-tools-11 libclang-common-11-dev libclang-11-dev libclang1-11 clang-format-11 python-clang-11 clangd-11
      - sudo apt-get install libomp-11-dev
      - chmod +x scripts/travis/install_boost.sh
      - scripts/travis/install_boost.sh
    script:
      - echo $LLVM_HOME
      - ls $LLVM_HOME
      - mkdir build && cd build
      - cmake -DCMAKE_C_COMPILER=$CLANG -DCMAKE_CXX_COMPILER=$CLANGPP ..
      - make